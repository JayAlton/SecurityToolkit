from .scanner import scan_target
from .fingerprint import identify_services
from .cve_lookup import find_vulnerabilities
from .formatter import print_report

def run():
    target = input("Enter target IP or hostname: ")
    ports = input("Ports to scan (e.g.22,80,443): ").split(",")
    ports = [int(p.strip()) for p in ports if p.strip().isdigit()]

    print(f"\n Scanning {target} on ports: {ports}...\n")
    services = scan_target(target, ports)

    print(f"\n Fingerprinting services...\n")
    fingerprints = identify_services(services)

    print(f"\n Querying CVEs...\n")
    cve_results = find_vulnerabilities(fingerprints)

    print("\n Vulnerability Report:\n")
    print_report(cve_results)
